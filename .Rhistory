selected <- select(SCC, SCC, EI.Sector)
selected <- selected[grepl("vehicle",selected$EI.Sector, ignore.case=TRUE),]
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510')
te
te <- tbl_df(merge (te, selected, by = "SCC"))
te
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_smooth()
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot() +
theme(legend.position="none") +
facet_grid(year~EI.Sector, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Total emission from from coal combustion-related sources")
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot() +
theme(legend.position="none") +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Total emission from from coal combustion-related sources")
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 5)
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Total emission from from coal combustion-related sources")
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 5) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 5) +
facet_grid(EI.Sector~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 3) +
facet_grid(EI.Sector~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 3) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 5) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 5) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 6) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot(outlier.shape=NA) +
theme(legend.position="none") +
ylim (0, 4) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions)) +
geom_boxplot() +
theme(legend.position="none") +
ylim (0, 4) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="none") +
ylim (0, 4) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom") +
ylim (0, 4) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom") +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot(outlier.shape = NA) +
theme(legend.position="bottom") +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="right", legend.direction = "vertical") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="bottom", legend.direction = "vertical") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="right", legend.direction = "vertical") +
ylim (0, 10) +
facet_grid(.~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
dev.copy(png, width=800, height=400, file = "plot5.png")
dev.off()
dev.copy(png, width=800, height=600, file = "plot5.png")
dev.off()
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
te <- tbl_df(merge (te, selected, by = "SCC"))
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="right", legend.direction = "vertical") +
ylim (0, 10) +
facet_grid(fips~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=Emissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="right", legend.direction = "vertical") +
facet_grid(fips~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions))
te
te
ggplot(data = te, aes(x=year, y=NormEmissions, col = EI.Sector)) +
geom_boxplot() +
theme(legend.position="right", legend.direction = "vertical") +
facet_grid(fips~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=NormEmissions)) +
geom_boxplot() +
theme(legend.position="none") +
facet_grid(fips~year, scales = "free") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
geom_quantile() +
theme(legend.position="none") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
geom_smooth() +
theme(legend.position="none") +
scale_x_continuous(breaks=c(1999, 2002, 2005, 2008))+
ggtitle ("Emissions from from motor vehicle sources")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
geom_smooth() +
theme(legend.position="none") +
ggtitle ("Emissions from from motor vehicle sources")
View(te)
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
stat_summary(fun.data = "sum") +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
stat_summary(fun.data = "sum") +
geom_abline() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
stat_summary(fun.data = "sum") +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=NormEmissions, col=fips)) +
stat_sum() +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=sum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=cumsum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=sum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=mean(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=sum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips,year) %>%
mutate (NormEmissions = Emissions/sum(Emissions))
ggplot(data = te, aes(x=year, y=sum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions))
#Plot data
ggplot(data = te, aes(x=year, y=sum(NormEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions)) %>%
summarise (TotalEmissions = sum())
te
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions)) %>%
summarise (TotalEmissions = sum(NormEmissions))
te
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions)) %>%
roup_by (fips, year) %>%
summarise (TotalEmissions = sum(NormEmissions))
te <- NEI %>%
filter (SCC %in% selected$SCC, fips == '24510' | fips == '06037')
#Add EI.Sector to subset
te <- tbl_df(merge (te, selected, by = "SCC"))
te <- te %>%
group_by (fips) %>%
mutate (NormEmissions = Emissions/sum(Emissions)) %>%
group_by (fips, year) %>%
summarise (TotalEmissions = sum(NormEmissions))
te
ggplot(data = te, aes(x=year, y=TotalEmissions), col=fips)) +
geom_line() +
theme(legend.position="none") +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
qplot (te$year, te$TotalEmissions)
qplot (te$year, te$TotalEmissions,geom = "line", col = fips)
qplot (te$year, te$TotalEmissions,geom = "line", col = te$fips)
qplot (te$year, te$TotalEmissions,geom = "line", col = te$fips) + theme(legend.text = c("LA", "Baltimore"))
ggplot(data = te, aes(x=year, y=TotalEmissions), col=fips)) +
geom_line() +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
te
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
geom_points() +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
geom_dotplot() +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
geom_point() +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
geom_point(size = 4) +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles")
ggplot(data = te, aes(x=year, y=TotalEmissions, col=fips)) +
geom_line() +
geom_point(size = 4) +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles") +
scale_fill_discrete(name="City",
breaks=c("06037", "24510"),
labels=c("LA", "Baltimore"))
ggplot(data = te, aes(x=year, y=TotalEmissions, group = fips, col=fips)) +
geom_line() +
geom_point(size = 4) +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles") +
scale_fill_discrete(name="City",
breaks=c("06037", "24510"),
labels=c("LA", "Baltimore"))
ggplot(data = te, aes(x=year, y=TotalEmissions, group = fips, col=fips)) +
geom_line() +
geom_point(size = 4) +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles") +
scale_colour_discrete(name="City",
breaks=c("06037", "24510"),
labels=c("LA", "Baltimore"))
ggplot(data = te, aes(x=year, y=TotalEmissions, group = fips, col=fips)) +
geom_line() +
geom_point(size = 4) +
ggtitle ("Comparison of Vehicle Emissions from Baltimore & Los Angeles") +
scale_colour_discrete(name="City",
breaks=c("06037", "24510"),
labels=c("LA", "Baltimore")) +
labs (y = "Proportion of total emissions from all time for the year")
dev.copy(png, width=600, height=600, file = "plot5.png")
dev.off()
dev.copy(png, width=600, height=600, file = "plot6.png")
dev.off()
install.packages("installr")
install.packages("installr")
setwd ("/home/nikita/R/RR/RepData_PeerAssessment1")
library (ggplot2)
if (!file.exists("activity.csv")) {unzip("activity.zip")}
activity <- read.table ("activity.csv", sep = ',', header = TRUE)
steps_by_day <- aggregate (steps~date, data=activity, sum)
hist (steps_by_day$steps, main="Histogram of the daily total number of steps", xlab= "Daily total steps number", col="red", breaks = 12 )
mean (steps_by_day$steps)
median (steps_by_day$steps)
day_pattern <- aggregate (steps~interval, data=activity, mean, na.rm=TRUE)
plot (day_pattern, type = "l", main = "Average daily activity pattern")
day_pattern$interval[which.max(day_pattern$steps)]
View(activity)
sum(is.na(activity$steps))
View(day_pattern)
steps_by_day_filled <- steps_by_day
sactivity_filled <- activity
activity_filled[is.na(activity_filled$steps)]
activity_filled <- activity
activity_filled <- activity
activity_filled[is.na(activity_filled$steps)]
activity_filled[is.na(activity_filled$steps),]
head(activity_filled[is.na(activity_filled$steps),])
complete <- activity
for i in 1:nrow(complete){
if is.na(complete$steps[i]){
complete$steps[i] <- day_pattern$steps[day_pattern$date = complete$date[i]]
}
}
for (i in 1:nrow(complete)){
if is.na(complete$steps[i]){
complete$steps[i] <- day_pattern$steps[day_pattern$date = complete$date[i]]
}
}
for (i in 1:nrow(complete)){
if is.na(complete$steps[i]){
complete$steps[i] <- day_pattern$steps[day_pattern$date == complete$date[i]]
}
}
for (i in 1:nrow(complete)){
if is.na(complete$steps[i]){
complete$steps[i] <- day_pattern$steps[day_pattern$date == complete$date[i]]
}
}
for (i in 1:nrow(complete)){
if (is.na(complete$steps[i])){
complete$steps[i] <- day_pattern$steps[day_pattern$date == complete$date[i]]
}
}
complete <- activity
for (i in 1:nrow(complete)){
if (is.na(complete$steps[i])){
complete$steps[i] <- day_pattern$steps[day_pattern$interval == complete$date[i]]
}
}
complete <- activity
for (i in 1:nrow(complete)){
if (is.na(complete$steps[i])){
complete$steps[i] <- day_pattern$steps[day_pattern$interval == complete$interval[i]]
}
}
View(complete)
steps_by_day_complete <- aggregate (steps~date, data=complete, sum)
hist (steps_by_day_complete$steps, main="Total number of steps per day", xlab= "Daily total steps number", col="red", breaks = 12 )
mean (steps_by_day_complete$steps)
median (steps_by_day_complete$steps)
steps_by_day_complete$date <- as.Date(steps_by_day_complete$date)
head (weekdays(steps_by_day_complete$date))
weekdays(steps_by_day_complete$date))
weekdays(steps_by_day_complete$date)
day_type <- function (x) {
if (x == 'Sunday' | x == 'Saturday'){"weekend"}
else {"weekday"}
}
day_type ('Monday')
day_type ('Sunday')
day_type (c('Monday','Sunday'))
day_type <- function (x) {
for i in length(x){
if (x[i] == 'Sunday' | x[i] == 'Saturday'){day[i] <- "weekend"}
else {day[i] <- "weekday"}
}
day
}
day_type <- function (x) {
for (i in length(x)){
if (x[i] == 'Sunday' | x[i] == 'Saturday'){day[i] <- "weekend"}
else {day[i] <- "weekday"}
}
day
}
day_type (c('Monday','Sunday'))
day_type <- function (x) {
day <- vector()
for (i in length(x)){
if (x[i] == 'Sunday' | x[i] == 'Saturday'){day[i] <- "weekend"}
else {day[i] <- "weekday"}
}
day
}
day_type (c('Monday','Sunday'))
day_type <- function (x) {
day <- vector()
for (i in length(x)){
if (x[i] == 'Sunday' | x[i] == 'Saturday'){day[i] <- "weekend"}
else {day[i] <- "weekday"}
}
day
}
day_type('Monday')
day_type(c('Monday','Tuesday'))
day_type <- function (x) {
day <- vector()
for (i in 1:length(x)){
if (x[i] == 'Sunday' | x[i] == 'Saturday'){day[i] <- "weekend"}
else {day[i] <- "weekday"}
}
day
}
day_type(c('Monday','Tuesday'))
day_type(c('Monday','Tuesday','Sunday'))
complete$day <- factor(ifelse(weekdays(complete$date) %in% c('Saturday','Sunday'), 'weekend', 'weekday'), levels = c('weekend','weekday'))
typeof (complete$date)
complete$date <- as.Date(complete$date)
complete$day <- factor(ifelse(weekdays(complete$date) %in% c('Saturday','Sunday'), 'weekend', 'weekday'), levels = c('weekend','weekday'))
View(complete)
library(lattice)
xyplot(steps ~ interval|day, data = complete, type = 'l', layout = c(1,2))
xyplot(steps ~ interval|day, data = complete, type = 'l', layout = c(1,1))
xyplot(steps ~ interval|day, data = complete, type = 'l', layout = c(1,2))
xyplot(steps ~ interval|day, data = pattern_by_day_type, type = 'l', layout = c(1,2))
pattern_by_day_type <- aggregate (steps~interval+day, data=complete, mean)
xyplot(steps ~ interval|day, data = pattern_by_day_type, type = 'l', layout = c(1,2))
